{% extends "base.html" %}
{% set title = page_title %}

{% block content %}
<section class="paper-section">
  <div class="mx-auto max-w-[1180px] px-5 md:px-8 py-16 md:py-20">
    <div class="grid gap-8 md:grid-cols-2 md:gap-14 items-end">
      <div>
        <h1 class="text-3xl md:text-4xl font-semibold tracking-tight">{{ page_heading }}</h1>
        <p class="mt-4 text-slate-700 leading-relaxed max-w-2xl">{{ page_description }}</p>
      </div>

      <div class="md:justify-self-end w-full md:max-w-[420px]">
        <div class="rounded-3xl border border-black/10 bg-white/70 backdrop-blur px-5 py-4">
          <div class="text-xs uppercase tracking-wide text-slate-500">Szukaj</div>
          <input id="searchInput" type="text" placeholder="Wpisz nazwę urządzenia..." class="mt-2 w-full bg-transparent outline-none text-slate-900" autocomplete="off">
          <div class="mt-2 text-xs text-slate-500"><span id="resultsCount">{{ products|length }}</span> wyników</div>
        </div>
      </div>
    </div>
  </div>

  <!-- GRID -->
  <div class="pb-20 md:pb-28">
    <div class="mx-auto max-w-[1180px] px-0 sm:px-5 md:px-8">
      <div class="grid grid-cols-2 md:grid-cols-3 gap-2 sm:gap-5 md:gap-6" id="productsGrid">
        {% for p in products %}
          <a href="{{ url_for('product_detail', slug=p.slug) }}"
             class="plist-card group block overflow-hidden rounded-none sm:rounded-3xl border border-black/10 bg-white/70 backdrop-blur hover:bg-white/85 transition"
             data-name="{{ (p.name ~ ' ' ~ (p.tag or '') ~ ' ' ~ (p.category_label or '') )|lower }}">
            <div class="relative bg-gradient-to-br from-white via-slate-50 to-slate-200">
              <img src="{{ p.thumb }}" alt="{{ p.name }}" loading="lazy" {% if p.photo_base %}data-photo-base="{{ p.photo_base }}"{% endif %}
                   class="w-full aspect-[4/3] object-contain p-3 sm:p-5 group-hover:scale-[1.01] transition">
              {% if p.badge %}
                <div class="absolute top-3 left-3 inline-flex items-center rounded-full bg-white/80 backdrop-blur px-3 py-1 text-xs font-semibold text-slate-900 border border-black/10">
                  {{ p.badge }}
                </div>
              {% endif %}
              <div class="pointer-events-none absolute inset-0" style="background:radial-gradient(1200px 360px at 20% 0%, rgba(15,23,42,.08), transparent 60%), radial-gradient(900px 280px at 90% 100%, rgba(15,23,42,.06), transparent 55%);"></div>
            </div>

            <div class="p-4 sm:p-5">
              <div class="text-xs text-slate-500">{{ p.tag }}</div>
              <div class="mt-2 text-base sm:text-lg font-semibold tracking-tight text-slate-900">{{ p.name }}</div>

              {% if p.short %}
                <p class="mt-2 text-sm text-slate-700 leading-relaxed line-clamp-3 hidden sm:block">{{ p.short }}</p>
              {% endif %}

              <div class="mt-4 flex items-center justify-between gap-4">
                <div class="text-sm text-slate-800">
                  {% if p.price %}<span class="font-semibold">{{ p.price }}</span>{% endif %}
                </div>
                <span class="text-sm text-slate-700 underline underline-offset-4">Otwórz</span>
              </div>
            </div>
          </a>
        {% endfor %}
      </div>

      <div id="noResults" class="hidden mt-10 text-sm text-slate-600">
        Brak wyników dla podanej frazy.
      </div>
    </div>
  </div>
</section>
{% endblock %}
